<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TeleMed - Cadastro Médico</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#f0f9ff',
                            100: '#e0f2fe',
                            200: '#bae6fd',
                            300: '#7dd3fc',
                            400: '#38bdf8',
                            500: '#0ea5e9',
                            600: '#0284c7',
                            700: '#0369a1',
                            800: '#075985',
                            900: '#0c4a6e',
                        },
                        medical: {
                            50: '#f0fdf4',
                            100: '#dcfce7',
                            200: '#bbf7d0',
                            300: '#86efac',
                            400: '#4ade80',
                            500: '#22c55e',
                            600: '#16a34a',
                            700: '#15803d',
                            800: '#166534',
                            900: '#14532d',
                        }
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.5s ease-in-out',
                        'slide-up': 'slideUp 0.3s ease-out',
                        'shake': 'shake 0.5s ease-in-out',
                    },
                }
            }
        }
    </script>
    <style>
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        @keyframes slideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        
        .form-step {
            display: none;
        }
        .form-step.active {
            display: block;
            animation: slideUp 0.3s ease-out;
        }
        
        .spinner {
            border: 2px solid #f3f3f3;
            border-top: 2px solid #22c55e;
            border-radius: 50%;
            width: 16px;
            height: 16px;
            animation: spin 1s linear infinite;
            display: inline-block;
            margin-right: 8px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .progress-bar {
            transition: width 0.3s ease;
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen">
    <!-- Header -->
    <header class="bg-white shadow-sm">
        <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center py-4">
                <div class="flex items-center">
                    <h1 class="text-2xl font-bold text-primary-600">TeleMed</h1>
                    <span class="ml-2 text-sm text-gray-500 font-medium">Cadastro Médico</span>
                </div>
                <div class="flex items-center space-x-4">
                    <button onclick="redirectToDoctors()" 
                            class="text-gray-600 hover:text-primary-600 font-medium transition-colors">
                        Voltar
                    </button>
                    <button onclick="redirectToAuth()" 
                            class="text-gray-600 hover:text-primary-600 font-medium transition-colors">
                        Já tenho conta
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="bg-white border-b">
        <div class="max-w-4xl mx-auto px-4">
            <div class="py-4">
                <div class="flex items-center justify-between mb-2">
                    <span class="text-sm font-medium text-gray-600">Progresso do Cadastro</span>
                    <span class="text-sm font-medium text-gray-600" id="progressText">Passo 1 de 3</span>
                </div>
                <div class="w-full bg-gray-200 rounded-full h-2">
                    <div class="progress-bar bg-medical-600 h-2 rounded-full" id="progressBar" style="width: 33%"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <main class="max-w-4xl mx-auto px-4 py-8">
        <div class="bg-white rounded-lg shadow-lg p-8">
            <!-- Step 1: Documentação Pessoal Obrigatória -->
            <div class="form-step active" id="step1">
                <div class="text-center mb-8">
                    <h2 class="text-3xl font-bold text-gray-900 mb-2">📋 Documentação Pessoal Obrigatória</h2>
                    <p class="text-gray-600">Conforme exigido pelo CFM - Conselho Federal de Medicina</p>
                </div>

                <form id="personalDataForm" class="space-y-8">
                    <!-- Identidade e CPF -->
                    <div class="bg-blue-50 p-6 rounded-lg">
                        <h3 class="text-lg font-semibold text-blue-900 mb-4">🆔 Identidade e CPF</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label for="fullName" class="block text-sm font-medium text-gray-700 mb-2">
                                    Nome Completo (conforme RG) *
                                </label>
                                <input type="text" id="fullName" name="fullName" required
                                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-medical-500 focus:border-transparent"
                                       placeholder="Dr. João Silva Santos">
                            </div>

                            <div>
                                <label for="cpf" class="block text-sm font-medium text-gray-700 mb-2">
                                    CPF (Cadastro de Pessoa Física válido) *
                                </label>
                                <input type="text" id="cpf" name="cpf" required
                                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-medical-500 focus:border-transparent"
                                       placeholder="000.000.000-00">
                            </div>

                            <div>
                                <label for="rg" class="block text-sm font-medium text-gray-700 mb-2">
                                    RG - Registro Geral (frente e verso) *
                                </label>
                                <input type="text" id="rg" name="rg" required
                                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-medical-500 focus:border-transparent"
                                       placeholder="00.000.000-0">
                            </div>

                            <div>
                                <label for="birthDate" class="block text-sm font-medium text-gray-700 mb-2">
                                    Data de Nascimento (verificação idade mínima) *
                                </label>
                                <input type="date" id="birthDate" name="birthDate" required
                                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-medical-500 focus:border-transparent">
                            </div>
                        </div>
                    </div>

                    <!-- Dados de Contato -->
                    <div class="bg-green-50 p-6 rounded-lg">
                        <h3 class="text-lg font-semibold text-green-900 mb-4">📞 Dados de Contato</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label for="email" class="block text-sm font-medium text-gray-700 mb-2">
                                    Email Profissional (comunicações oficiais) *
                                </label>
                                <input type="email" id="email" name="email" required
                                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-medical-500 focus:border-transparent"
                                       placeholder="joao.silva@email.com">
                            </div>

                            <div>
                                <label for="phone" class="block text-sm font-medium text-gray-700 mb-2">
                                    Telefone/Celular (contato emergencial) *
                                </label>
                                <input type="tel" id="phone" name="phone" required
                                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-medical-500 focus:border-transparent"
                                       placeholder="(11) 99999-9999">
                            </div>

                            <div class="md:col-span-2">
                                <label for="address" class="block text-sm font-medium text-gray-700 mb-2">
                                    Endereço Completo (residencial ou profissional) *
                                </label>
                                <input type="text" id="address" name="address" required
                                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-medical-500 focus:border-transparent"
                                       placeholder="Rua das Flores, 123, Apto 45, Centro, São Paulo - SP, 01234-567">
                            </div>

                            <div>
                                <label for="gender" class="block text-sm font-medium text-gray-700 mb-2">
                                    Gênero *
                                </label>
                                <select id="gender" name="gender" required
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-medical-500 focus:border-transparent">
                                    <option value="">Selecione</option>
                                    <option value="masculino">Masculino</option>
                                    <option value="feminino">Feminino</option>
                                    <option value="outro">Outro</option>
                                    <option value="nao-informar">Prefiro não informar</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="flex justify-end">
                        <button type="button" onclick="nextStep(1)" 
                                class="bg-medical-600 hover:bg-medical-700 text-white font-bold py-3 px-8 rounded-lg transition-colors">
                            Próximo: Documentação Profissional
                        </button>
                    </div>
                </form>
            </div>

            <!-- Step 2: Documentação Profissional Obrigatória -->
            <div class="form-step" id="step2">
                <div class="text-center mb-8">
                    <h2 class="text-3xl font-bold text-gray-900 mb-2">🏥 Documentação Profissional Obrigatória</h2>
                    <p class="text-gray-600">Registro profissional, formação acadêmica e dados financeiros</p>
                </div>

                <form id="professionalDataForm" class="space-y-8">
                    <!-- Registro Profissional -->
                    <div class="bg-red-50 p-6 rounded-lg">
                        <h3 class="text-lg font-semibold text-red-900 mb-4">🏥 Registro Profissional</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label for="crm" class="block text-sm font-medium text-gray-700 mb-2">
                                    Número do CRM (Conselho Regional de Medicina) *
                                </label>
                                <input type="text" id="crm" name="crm" required
                                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-medical-500 focus:border-transparent"
                                       placeholder="123456">
                            </div>

                            <div>
                                <label for="crmState" class="block text-sm font-medium text-gray-700 mb-2">
                                    Estado do CRM (UF onde está registrado) *
                                </label>
                                <select id="crmState" name="crmState" required
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-medical-500 focus:border-transparent">
                                    <option value="">Selecione</option>
                                    <option value="AC">Acre</option>
                                    <option value="AL">Alagoas</option>
                                    <option value="AP">Amapá</option>
                                    <option value="AM">Amazonas</option>
                                    <option value="BA">Bahia</option>
                                    <option value="CE">Ceará</option>
                                    <option value="DF">Distrito Federal</option>
                                    <option value="ES">Espírito Santo</option>
                                    <option value="GO">Goiás</option>
                                    <option value="MA">Maranhão</option>
                                    <option value="MT">Mato Grosso</option>
                                    <option value="MS">Mato Grosso do Sul</option>
                                    <option value="MG">Minas Gerais</option>
                                    <option value="PA">Pará</option>
                                    <option value="PB">Paraíba</option>
                                    <option value="PR">Paraná</option>
                                    <option value="PE">Pernambuco</option>
                                    <option value="PI">Piauí</option>
                                    <option value="RJ">Rio de Janeiro</option>
                                    <option value="RN">Rio Grande do Norte</option>
                                    <option value="RS">Rio Grande do Sul</option>
                                    <option value="RO">Rondônia</option>
                                    <option value="RR">Roraima</option>
                                    <option value="SC">Santa Catarina</option>
                                    <option value="SP">São Paulo</option>
                                    <option value="SE">Sergipe</option>
                                    <option value="TO">Tocantins</option>
                                </select>
                            </div>

                            <div class="md:col-span-2">
                                <label class="block text-sm font-medium text-gray-700 mb-2">
                                    Situação no CRM (deve estar ativa/regular) *
                                </label>
                                <div class="flex items-center space-x-6">
                                    <label class="flex items-center">
                                        <input type="radio" name="crmStatus" value="ativo" required class="mr-2">
                                        <span class="text-sm">Ativo/Regular</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="radio" name="crmStatus" value="suspenso" class="mr-2">
                                        <span class="text-sm">Suspenso</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="radio" name="crmStatus" value="cassado" class="mr-2">
                                        <span class="text-sm">Cassado</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Formação Acadêmica -->
                    <div class="bg-blue-50 p-6 rounded-lg">
                        <h3 class="text-lg font-semibold text-blue-900 mb-4">🎓 Formação Acadêmica</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label for="medicalSchool" class="block text-sm font-medium text-gray-700 mb-2">
                                    Faculdade de Medicina (nome da instituição) *
                                </label>
                                <input type="text" id="medicalSchool" name="medicalSchool" required
                                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-medical-500 focus:border-transparent"
                                       placeholder="Universidade de São Paulo">
                            </div>

                            <div>
                                <label for="graduationYear" class="block text-sm font-medium text-gray-700 mb-2">
                                    Ano de Formação (data de conclusão) *
                                </label>
                                <input type="number" id="graduationYear" name="graduationYear" required min="1950" max="2024"
                                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-medical-500 focus:border-transparent"
                                       placeholder="2020">
                            </div>

                            <div>
                                <label for="diplomaRecognized" class="block text-sm font-medium text-gray-700 mb-2">
                                    Diploma reconhecido pelo MEC *
                                </label>
                                <select id="diplomaRecognized" name="diplomaRecognized" required
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-medical-500 focus:border-transparent">
                                    <option value="">Selecione</option>
                                    <option value="sim">Sim, reconhecido pelo MEC</option>
                                    <option value="revalidacao">Em processo de revalidação</option>
                                    <option value="exterior">Diploma do exterior</option>
                                </select>
                            </div>

                            <div>
                                <label for="completionCertificate" class="block text-sm font-medium text-gray-700 mb-2">
                                    Certificado de Conclusão
                                </label>
                                <select id="completionCertificate" name="completionCertificate"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-medical-500 focus:border-transparent">
                                    <option value="">Não aplicável</option>
                                    <option value="sim">Possuo certificado</option>
                                    <option value="nao">Não possuo</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Especialização -->
                    <div class="bg-purple-50 p-6 rounded-lg">
                        <h3 class="text-lg font-semibold text-purple-900 mb-4">🏆 Especialização (Quando Aplicável)</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label for="rqe" class="block text-sm font-medium text-gray-700 mb-2">
                                    RQE - Registro de Qualificação de Especialista
                                </label>
                                <input type="text" id="rqe" name="rqe"
                                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-medical-500 focus:border-transparent"
                                       placeholder="Número do RQE (se aplicável)">
                            </div>

                            <div>
                                <label for="residencyCertificate" class="block text-sm font-medium text-gray-700 mb-2">
                                    Certificado de Residência Médica
                                </label>
                                <input type="text" id="residencyCertificate" name="residencyCertificate"
                                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-medical-500 focus:border-transparent"
                                       placeholder="Instituição da residência">
                            </div>

                            <div>
                                <label for="specialistTitle" class="block text-sm font-medium text-gray-700 mb-2">
                                    Título de Especialista (emitido por sociedade médica)
                                </label>
                                <input type="text" id="specialistTitle" name="specialistTitle"
                                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-medical-500 focus:border-transparent"
                                       placeholder="Sociedade emissora do título">
                            </div>

                            <div>
                                <label for="specializationCertificates" class="block text-sm font-medium text-gray-700 mb-2">
                                    Certificados de Especialização (cursos complementares)
                                </label>
                                <textarea id="specializationCertificates" name="specializationCertificates" rows="3"
                                          class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-medical-500 focus:border-transparent"
                                          placeholder="Liste seus certificados de especialização"></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- Especialidades Médicas Aceitas -->
                    <div class="bg-green-50 p-6 rounded-lg">
                        <h3 class="text-lg font-semibold text-green-900 mb-4">🩺 Especialidades Médicas Aceitas</h3>
                        <div class="grid grid-cols-2 md:grid-cols-3 gap-3">
                            <label class="flex items-center">
                                <input type="checkbox" name="specialties" value="clinica-geral" class="mr-2">
                                <span class="text-sm">Clínica Geral</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" name="specialties" value="cardiologia" class="mr-2">
                                <span class="text-sm">Cardiologia</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" name="specialties" value="dermatologia" class="mr-2">
                                <span class="text-sm">Dermatologia</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" name="specialties" value="pediatria" class="mr-2">
                                <span class="text-sm">Pediatria</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" name="specialties" value="ginecologia" class="mr-2">
                                <span class="text-sm">Ginecologia</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" name="specialties" value="psiquiatria" class="mr-2">
                                <span class="text-sm">Psiquiatria</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" name="specialties" value="neurologia" class="mr-2">
                                <span class="text-sm">Neurologia</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" name="specialties" value="endocrinologia" class="mr-2">
                                <span class="text-sm">Endocrinologia</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" name="specialties" value="ortopedia" class="mr-2">
                                <span class="text-sm">Ortopedia</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" name="specialties" value="urologia" class="mr-2">
                                <span class="text-sm">Urologia</span>
                            </label>
                        </div>
                        <p class="text-sm text-green-700 mt-2">* Selecione pelo menos uma especialidade</p>
                    </div>

                    <!-- Experiência e Requisitos -->
                    <div class="bg-yellow-50 p-6 rounded-lg">
                        <h3 class="text-lg font-semibold text-yellow-900 mb-4">📊 Experiência e Requisitos</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label for="experienceYears" class="block text-sm font-medium text-gray-700 mb-2">
                                    Anos de Experiência (mínima por especialidade) *
                                </label>
                                <select id="experienceYears" name="experienceYears" required
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-medical-500 focus:border-transparent">
                                    <option value="">Selecione</option>
                                    <option value="1-2">1-2 anos</option>
                                    <option value="3-5">3-5 anos</option>
                                    <option value="6-10">6-10 anos</option>
                                    <option value="11-15">11-15 anos</option>
                                    <option value="16-20">16-20 anos</option>
                                    <option value="20+">Mais de 20 anos</option>
                                </select>
                            </div>

                            <div>
                                <label for="telemedicineExperience" class="block text-sm font-medium text-gray-700 mb-2">
                                    Experiência em Telemedicina (diferencial)
                                </label>
                                <select id="telemedicineExperience" name="telemedicineExperience"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-medical-500 focus:border-transparent">
                                    <option value="">Selecione</option>
                                    <option value="nenhuma">Nenhuma experiência</option>
                                    <option value="basica">Experiência básica</option>
                                    <option value="intermediaria">Experiência intermediária</option>
                                    <option value="avancada">Experiência avançada</option>
                                </select>
                            </div>

                            <div class="md:col-span-2">
                                <label for="publications" class="block text-sm font-medium text-gray-700 mb-2">
                                    Publicações (artigos e pesquisas)
                                </label>
                                <textarea id="publications" name="publications" rows="3"
                                          class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-medical-500 focus:border-transparent"
                                          placeholder="Liste suas publicações científicas (opcional)"></textarea>
                            </div>

                            <div class="md:col-span-2">
                                <label for="positiveEvaluations" class="block text-sm font-medium text-gray-700 mb-2">
                                    Avaliações Positivas (em outras plataformas)
                                </label>
                                <textarea id="positiveEvaluations" name="positiveEvaluations" rows="2"
                                          class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-medical-500 focus:border-transparent"
                                          placeholder="Mencione avaliações positivas em outras plataformas (opcional)"></textarea>
                            </div>
                        </div>
                    </div>

                    <div class="flex justify-between">
                        <button type="button" onclick="prevStep(2)" 
                                class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-3 px-8 rounded-lg transition-colors">
                            Voltar
                        </button>
                        <button type="button" onclick="nextStep(2)" 
                                class="bg-medical-600 hover:bg-medical-700 text-white font-bold py-3 px-8 rounded-lg transition-colors">
                            Próximo: Dados Financeiros e Técnicos
                        </button>
                    </div>
                </form>
            </div>

            <!-- Step 3: Dados Financeiros, Técnicos e Finalização -->
            <div class="form-step" id="step3">
                <div class="text-center mb-8">
                    <h2 class="text-3xl font-bold text-gray-900 mb-2">💰 Dados Financeiros, Técnicos e Finalização</h2>
                    <p class="text-gray-600">Informações para recebimentos, requisitos técnicos e aspectos legais</p>
                </div>

                <form id="documentsForm" class="space-y-8">
                    <!-- Dados Financeiros e Fiscais -->
                    <div class="bg-green-50 p-6 rounded-lg">
                        <h3 class="text-lg font-semibold text-green-900 mb-4">💳 Informações Bancárias</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label for="bank" class="block text-sm font-medium text-gray-700 mb-2">
                                    Banco (instituição financeira) *
                                </label>
                                <select id="bank" name="bank" required
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-medical-500 focus:border-transparent">
                                    <option value="">Selecione</option>
                                    <option value="001">Banco do Brasil</option>
                                    <option value="237">Bradesco</option>
                                    <option value="104">Caixa Econômica Federal</option>
                                    <option value="341">Itaú</option>
                                    <option value="033">Santander</option>
                                    <option value="260">Nu Pagamentos (Nubank)</option>
                                    <option value="077">Banco Inter</option>
                                    <option value="212">Banco Original</option>
                                    <option value="290">PagSeguro</option>
                                    <option value="323">Mercado Pago</option>
                                    <option value="outros">Outros</option>
                                </select>
                            </div>

                            <div>
                                <label for="agency" class="block text-sm font-medium text-gray-700 mb-2">
                                    Agência (número da agência) *
                                </label>
                                <input type="text" id="agency" name="agency" required
                                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-medical-500 focus:border-transparent"
                                       placeholder="1234">
                            </div>

                            <div>
                                <label for="account" class="block text-sm font-medium text-gray-700 mb-2">
                                    Conta Corrente (número da conta) *
                                </label>
                                <input type="text" id="account" name="account" required
                                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-medical-500 focus:border-transparent"
                                       placeholder="12345-6">
                            </div>

                            <div>
                                <label for="pixKey" class="block text-sm font-medium text-gray-700 mb-2">
                                    PIX - Chave PIX (CPF, email ou telefone) *
                                </label>
                                <input type="text" id="pixKey" name="pixKey" required
                                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-medical-500 focus:border-transparent"
                                       placeholder="000.000.000-00 ou email@exemplo.com">
                            </div>
                        </div>

                        <div class="mt-6">
                            <h4 class="text-md font-semibold text-green-900 mb-4">📊 Situação Fiscal</h4>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">
                                        Situação Fiscal *
                                    </label>
                                    <div class="space-y-2">
                                        <label class="flex items-center">
                                            <input type="radio" name="taxStatus" value="pessoa-fisica" required class="mr-2">
                                            <span class="text-sm">Pessoa Física - CPF individual</span>
                                        </label>
                                        <label class="flex items-center">
                                            <input type="radio" name="taxStatus" value="mei" class="mr-2">
                                            <span class="text-sm">MEI - Microempreendedor Individual</span>
                                        </label>
                                        <label class="flex items-center">
                                            <input type="radio" name="taxStatus" value="pessoa-juridica" class="mr-2">
                                            <span class="text-sm">Pessoa Jurídica - CNPJ empresarial</span>
                                        </label>
                                    </div>
                                </div>

                                <div>
                                    <label for="cnpj" class="block text-sm font-medium text-gray-700 mb-2">
                                        CNPJ (se aplicável)
                                    </label>
                                    <input type="text" id="cnpj" name="cnpj"
                                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-medical-500 focus:border-transparent"
                                           placeholder="00.000.000/0001-00">
                                </div>
                            </div>
                        </div>

                        <div class="mt-6">
                            <h4 class="text-md font-semibold text-green-900 mb-4">💰 Precificação</h4>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                                <div>
                                    <label for="normalConsultationPrice" class="block text-sm font-medium text-gray-700 mb-2">
                                        Valor por consulta normal (preço padrão) *
                                    </label>
                                    <input type="number" id="normalConsultationPrice" name="normalConsultationPrice" required min="30" max="200"
                                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-medical-500 focus:border-transparent"
                                           placeholder="89">
                                </div>

                                <div>
                                    <label for="urgentConsultationPrice" class="block text-sm font-medium text-gray-700 mb-2">
                                        Valor por consulta urgente (preço premium)
                                    </label>
                                    <input type="number" id="urgentConsultationPrice" name="urgentConsultationPrice" min="50" max="300"
                                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-medical-500 focus:border-transparent"
                                           placeholder="129">
                                </div>

                                <div>
                                    <label for="returnConsultationPrice" class="block text-sm font-medium text-gray-700 mb-2">
                                        Valor por retorno (consulta de acompanhamento)
                                    </label>
                                    <input type="number" id="returnConsultationPrice" name="returnConsultationPrice" min="20" max="150"
                                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-medical-500 focus:border-transparent"
                                           placeholder="59">
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Disponibilidade de Atendimento -->
                    <div class="bg-blue-50 p-6 rounded-lg">
                        <h3 class="text-lg font-semibold text-blue-900 mb-4">⏰ Disponibilidade de Atendimento</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">
                                    Horários Semanais *
                                </label>
                                <div class="space-y-2">
                                    <label class="flex items-center">
                                        <input type="checkbox" name="weeklySchedule" value="segunda-sexta" class="mr-2">
                                        <span class="text-sm">Segunda a Sexta - Manhã, tarde, noite</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" name="weeklySchedule" value="fins-semana" class="mr-2">
                                        <span class="text-sm">Fins de Semana - Disponibilidade opcional</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" name="weeklySchedule" value="plantoes" class="mr-2">
                                        <span class="text-sm">Plantões - Atendimento 24h (opcional)</span>
                                    </label>
                                </div>
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">
                                    Turnos Disponíveis *
                                </label>
                                <div class="space-y-2">
                                    <label class="flex items-center">
                                        <input type="checkbox" name="availableShifts" value="manha" class="mr-2">
                                        <span class="text-sm">Manhã - 08:00 às 12:00</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" name="availableShifts" value="tarde" class="mr-2">
                                        <span class="text-sm">Tarde - 14:00 às 18:00</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" name="availableShifts" value="noite" class="mr-2">
                                        <span class="text-sm">Noite - 19:00 às 22:00</span>
                                    </label>
                                </div>
                            </div>

                            <div class="md:col-span-2">
                                <label class="block text-sm font-medium text-gray-700 mb-2">
                                    Modalidades de Atendimento *
                                </label>
                                <div class="flex space-x-6">
                                    <label class="flex items-center">
                                        <input type="checkbox" name="serviceModalities" value="videochamada" required class="mr-2">
                                        <span class="text-sm">Videochamada - Principal modalidade</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" name="serviceModalities" value="chat" class="mr-2">
                                        <span class="text-sm">Chat - Atendimento por texto</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" name="serviceModalities" value="telefone" class="mr-2">
                                        <span class="text-sm">Telefone - Quando aplicável</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Requisitos Técnicos -->
                    <div class="bg-purple-50 p-6 rounded-lg">
                        <h3 class="text-lg font-semibold text-purple-900 mb-4">💻 Requisitos Técnicos</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">
                                    Equipamentos Mínimos *
                                </label>
                                <div class="space-y-2">
                                    <label class="flex items-center">
                                        <input type="checkbox" name="equipment" value="computador-webcam" required class="mr-2">
                                        <span class="text-sm">Computador/Tablet - Com webcam e microfone</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" name="equipment" value="internet-estavel" required class="mr-2">
                                        <span class="text-sm">Internet estável - Mínimo 10 Mbps</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" name="equipment" value="ambiente-adequado" required class="mr-2">
                                        <span class="text-sm">Ambiente adequado - Privado e profissional</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" name="equipment" value="iluminacao" required class="mr-2">
                                        <span class="text-sm">Iluminação - Adequada para videochamadas</span>
                                    </label>
                                </div>
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">
                                    Software e Aplicativos *
                                </label>
                                <div class="space-y-2">
                                    <label class="flex items-center">
                                        <input type="checkbox" name="software" value="navegador-atualizado" required class="mr-2">
                                        <span class="text-sm">Navegador atualizado - Chrome, Firefox, Safari</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" name="software" value="app-mobile" class="mr-2">
                                        <span class="text-sm">Aplicativo móvel - Da plataforma (quando houver)</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" name="software" value="videochamada-integrada" required class="mr-2">
                                        <span class="text-sm">Software de videochamada - Integrado à plataforma</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Certificações e Seguros -->
                    <div class="bg-red-50 p-6 rounded-lg">
                        <h3 class="text-lg font-semibold text-red-900 mb-4">🛡️ Certificações e Seguros Obrigatórios</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">
                                    Certificações Específicas
                                </label>
                                <div class="space-y-2">
                                    <label class="flex items-center">
                                        <input type="checkbox" name="certifications" value="telemedicina-curso" class="mr-2">
                                        <span class="text-sm">Curso de Telemedicina - Recomendado ou obrigatório</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" name="certifications" value="certificacao-digital" class="mr-2">
                                        <span class="text-sm">Certificação Digital - Conhecimento em tecnologia</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" name="certifications" value="etica-medica-digital" class="mr-2">
                                        <span class="text-sm">Curso de Ética Médica Digital - Específico para online</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" name="certifications" value="lgpd" class="mr-2">
                                        <span class="text-sm">LGPD - Lei Geral de Proteção de Dados</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" name="certifications" value="prontuario-eletronico" class="mr-2">
                                        <span class="text-sm">Prontuário Eletrônico - Certificação em PEP</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" name="certifications" value="assinatura-digital" class="mr-2">
                                        <span class="text-sm">Assinatura Digital - ICP-Brasil (quando exigida)</span>
                                    </label>
                                </div>
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">
                                    Seguros Obrigatórios *
                                </label>
                                <div class="space-y-2">
                                    <label class="flex items-center">
                                        <input type="checkbox" name="insurance" value="responsabilidade-civil" required class="mr-2">
                                        <span class="text-sm">Seguro de Responsabilidade Civil - Cobertura médica</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" name="insurance" value="seguro-vida" class="mr-2">
                                        <span class="text-sm">Seguro de Vida - Recomendado</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" name="insurance" value="erros-omissoes" class="mr-2">
                                        <span class="text-sm">Seguro contra Erros e Omissões - Específico</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Senha e Finalização -->
                    <div class="bg-gray-50 p-6 rounded-lg">
                        <h3 class="text-lg font-semibold text-gray-900 mb-4">🔐 Senha e Finalização</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label for="password" class="block text-sm font-medium text-gray-700 mb-2">
                                    Senha *
                                </label>
                                <input type="password" id="password" name="password" required
                                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-medical-500 focus:border-transparent"
                                       placeholder="Mínimo 8 caracteres">
                                <div class="mt-2">
                                    <div class="password-strength-bar" id="passwordStrengthBar"></div>
                                    <p class="text-sm text-gray-500 mt-1" id="passwordHint">
                                        Mínimo 8 caracteres com letras, números e símbolos
                                    </p>
                                </div>
                            </div>

                            <div>
                                <label for="confirmPassword" class="block text-sm font-medium text-gray-700 mb-2">
                                    Confirmar Senha *
                                </label>
                                <input type="password" id="confirmPassword" name="confirmPassword" required
                                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-medical-500 focus:border-transparent"
                                       placeholder="Digite a senha novamente">
                            </div>
                        </div>
                    </div>

                    <!-- Documentos Necessários -->
                    <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-6">
                        <h4 class="font-medium text-yellow-800 mb-3">📋 Lista de Verificação - Documentos Necessários</h4>
                        <p class="text-sm text-yellow-700 mb-4">
                            Após o cadastro, você receberá um email com instruções para envio dos seguintes documentos:
                        </p>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <h5 class="font-semibold text-yellow-800 mb-2">📄 Documentos Pessoais:</h5>
                                <ul class="text-sm text-yellow-700 space-y-1">
                                    <li>☐ CPF e RG digitalizados</li>
                                    <li>☐ Carteira do CRM (frente e verso)</li>
                                    <li>☐ Diploma de medicina</li>
                                    <li>☐ Comprovante de endereço atualizado</li>
                                    <li>☐ Certificados de especialização</li>
                                </ul>
                            </div>
                            <div>
                                <h5 class="font-semibold text-yellow-800 mb-2">💼 Documentos Profissionais:</h5>
                                <ul class="text-sm text-yellow-700 space-y-1">
                                    <li>☐ Dados bancários completos</li>
                                    <li>☐ Definição de horários disponíveis</li>
                                    <li>☐ Definição de valores de consulta</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Aspectos Legais e Regulatórios -->
                    <div class="bg-red-50 border border-red-200 rounded-lg p-6">
                        <h4 class="font-medium text-red-800 mb-3">⚖️ Aspectos Legais e Regulatórios</h4>
                        <div class="space-y-4">
                            <div>
                                <h5 class="font-semibold text-red-800 mb-2">📋 Normas do CFM</h5>
                                <div class="space-y-2">
                                    <label class="flex items-start">
                                        <input type="checkbox" id="cfmResolution" name="cfmResolution" required class="mt-1 mr-3">
                                        <span class="text-sm text-red-700">
                                            Declaro conhecer e concordar em cumprir a Resolução CFM nº 2.314/2022 - Telemedicina *
                                        </span>
                                    </label>
                                    <label class="flex items-start">
                                        <input type="checkbox" id="medicalEthics" name="medicalEthics" required class="mt-1 mr-3">
                                        <span class="text-sm text-red-700">
                                            Declaro conhecer e cumprir o Código de Ética Médica - Cumprimento obrigatório *
                                        </span>
                                    </label>
                                    <label class="flex items-start">
                                        <input type="checkbox" id="civilResponsibility" name="civilResponsibility" required class="mt-1 mr-3">
                                        <span class="text-sm text-red-700">
                                            Assumo total responsabilidade civil - Seguro profissional *
                                        </span>
                                    </label>
                                </div>
                            </div>

                            <div>
                                <h5 class="font-semibold text-red-800 mb-2">📄 Termos e Condições</h5>
                                <div class="space-y-2">
                                    <label class="flex items-start">
                                        <input type="checkbox" id="serviceContract" name="serviceContract" required class="mt-1 mr-3">
                                        <span class="text-sm text-red-700">
                                            Aceito o Contrato de Prestação de Serviços - Com a plataforma *
                                        </span>
                                    </label>
                                    <label class="flex items-start">
                                        <input type="checkbox" id="privacyPolicy" name="privacyPolicy" required class="mt-1 mr-3">
                                        <span class="text-sm text-red-700">
                                            Li e aceito a <a href="#" class="text-red-600 hover:underline">Política de Privacidade</a> - Concordância obrigatória *
                                        </span>
                                    </label>
                                    <label class="flex items-start">
                                        <input type="checkbox" id="platformTerms" name="platformTerms" required class="mt-1 mr-3">
                                        <span class="text-sm text-red-700">
                                            Aceito os <a href="#" class="text-red-600 hover:underline">Termos de Uso</a> da plataforma específica *
                                        </span>
                                    </label>
                                    <label class="flex items-start">
                                        <input type="checkbox" id="dataProcessing" name="dataProcessing" required class="mt-1 mr-3">
                                        <span class="text-sm text-red-700">
                                            Autorizo o processamento dos meus dados pessoais para fins de cadastro e prestação de serviços *
                                        </span>
                                    </label>
                                </div>
                            </div>

                            <div>
                                <h5 class="font-semibold text-red-800 mb-2">📧 Comunicações</h5>
                                <label class="flex items-start">
                                    <input type="checkbox" id="marketingEmails" name="marketingEmails" class="mt-1 mr-3">
                                    <span class="text-sm text-red-700">
                                        Desejo receber emails sobre novidades, treinamentos e oportunidades da TeleMed
                                    </span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <div class="flex justify-between">
                        <button type="button" onclick="prevStep(3)" 
                                class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-3 px-8 rounded-lg transition-colors">
                            Voltar
                        </button>
                        <button type="submit" id="submitButton"
                                class="bg-medical-600 hover:bg-medical-700 text-white font-bold py-3 px-8 rounded-lg transition-colors">
                            Finalizar Cadastro Médico
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Messages -->
        <div id="errorMessage" class="mt-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded-lg hidden">
        </div>
        <div id="successMessage" class="mt-4 p-4 bg-green-100 border border-green-400 text-green-700 rounded-lg hidden">
        </div>
    </main>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="js/supabase.js"></script>
    <script>
        let currentStep = 1;
        const totalSteps = 3;

        // Função para ir para o próximo passo
        function nextStep(step) {
            if (validateStep(step)) {
                currentStep++;
                updateStep();
            }
        }

        // Função para voltar ao passo anterior
        function prevStep(step) {
            currentStep--;
            updateStep();
        }

        // Função para atualizar a exibição do passo
        function updateStep() {
            // Esconder todos os passos
            document.querySelectorAll('.form-step').forEach(step => {
                step.classList.remove('active');
            });

            // Mostrar passo atual
            document.getElementById(`step${currentStep}`).classList.add('active');

            // Atualizar barra de progresso
            const progress = (currentStep / totalSteps) * 100;
            document.getElementById('progressBar').style.width = `${progress}%`;
            document.getElementById('progressText').textContent = `Passo ${currentStep} de ${totalSteps}`;
        }

        // Função para validar cada passo
        function validateStep(step) {
            const form = document.getElementById(step === 1 ? 'personalDataForm' : step === 2 ? 'professionalDataForm' : 'documentsForm');
            const inputs = form.querySelectorAll('input[required], select[required]');
            let isValid = true;

            inputs.forEach(input => {
                if (!input.value.trim()) {
                    input.style.borderColor = '#ef4444';
                    isValid = false;
                } else {
                    input.style.borderColor = '#d1d5db';
                }
            });

            // Validação específica para especialidades no passo 2
            if (step === 2) {
                const specialties = form.querySelectorAll('input[name="specialties"]:checked');
                if (specialties.length === 0) {
                    showError('Selecione pelo menos uma especialidade');
                    isValid = false;
                }
            }

            // Validação específica para senhas no passo 3
            if (step === 3) {
                const password = document.getElementById('password').value;
                const confirmPassword = document.getElementById('confirmPassword').value;
                
                if (password !== confirmPassword) {
                    showError('As senhas não coincidem');
                    isValid = false;
                }

                if (password.length < 8) {
                    showError('A senha deve ter pelo menos 8 caracteres');
                    isValid = false;
                }
            }

            if (!isValid) {
                showError('Por favor, preencha todos os campos obrigatórios');
            }

            return isValid;
        }

        // Funções para exibir mensagens
        function showError(message) {
            const errorDiv = document.getElementById('errorMessage');
            errorDiv.textContent = message;
            errorDiv.classList.remove('hidden');
            document.getElementById('successMessage').classList.add('hidden');
            
            // Scroll para a mensagem
            errorDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }

        function showSuccess(message) {
            const successDiv = document.getElementById('successMessage');
            successDiv.textContent = message;
            successDiv.classList.remove('hidden');
            document.getElementById('errorMessage').classList.add('hidden');
            
            // Scroll para a mensagem
            successDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }

        function hideMessages() {
            document.getElementById('errorMessage').classList.add('hidden');
            document.getElementById('successMessage').classList.add('hidden');
        }

        // Função para redirecionar
        function redirectToDoctors() {
            window.location.href = 'doctors.html';
        }

        function redirectToAuth() {
            window.location.href = 'auth.html';
        }

        // Submissão do formulário final
        document.getElementById('documentsForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            if (!validateStep(3)) {
                return;
            }

            const submitButton = document.getElementById('submitButton');
            const originalText = submitButton.textContent;
            
            // Mostrar loading
            submitButton.innerHTML = '<span class="spinner"></span>Processando...';
            submitButton.disabled = true;

            try {
                // Coletar todos os dados dos formulários
                const personalData = new FormData(document.getElementById('personalDataForm'));
                const professionalData = new FormData(document.getElementById('professionalDataForm'));
                const documentsData = new FormData(document.getElementById('documentsForm'));

                // Coletar especialidades selecionadas
                const specialties = Array.from(document.querySelectorAll('input[name="specialties"]:checked'))
                    .map(input => input.value);

                // Coletar arrays de checkboxes
                const weeklySchedule = Array.from(document.querySelectorAll('input[name="weeklySchedule"]:checked'))
                    .map(input => input.value);
                const availableShifts = Array.from(document.querySelectorAll('input[name="availableShifts"]:checked'))
                    .map(input => input.value);
                const serviceModalities = Array.from(document.querySelectorAll('input[name="serviceModalities"]:checked'))
                    .map(input => input.value);
                const equipment = Array.from(document.querySelectorAll('input[name="equipment"]:checked'))
                    .map(input => input.value);
                const software = Array.from(document.querySelectorAll('input[name="software"]:checked'))
                    .map(input => input.value);
                const certifications = Array.from(document.querySelectorAll('input[name="certifications"]:checked'))
                    .map(input => input.value);
                const insurance = Array.from(document.querySelectorAll('input[name="insurance"]:checked'))
                    .map(input => input.value);

                const doctorData = {
                    // Dados pessoais
                    fullName: personalData.get('fullName'),
                    cpf: personalData.get('cpf'),
                    rg: personalData.get('rg'),
                    birthDate: personalData.get('birthDate'),
                    email: personalData.get('email'),
                    phone: personalData.get('phone'),
                    address: personalData.get('address'),
                    gender: personalData.get('gender'),
                    
                    // Dados profissionais
                    crm: professionalData.get('crm'),
                    crmState: professionalData.get('crmState'),
                    crmStatus: professionalData.get('crmStatus'),
                    medicalSchool: professionalData.get('medicalSchool'),
                    graduationYear: professionalData.get('graduationYear'),
                    diplomaRecognized: professionalData.get('diplomaRecognized'),
                    completionCertificate: professionalData.get('completionCertificate'),
                    rqe: professionalData.get('rqe'),
                    residencyCertificate: professionalData.get('residencyCertificate'),
                    specialistTitle: professionalData.get('specialistTitle'),
                    specializationCertificates: professionalData.get('specializationCertificates'),
                    specialties: specialties,
                    experienceYears: professionalData.get('experienceYears'),
                    telemedicineExperience: professionalData.get('telemedicineExperience'),
                    publications: professionalData.get('publications'),
                    positiveEvaluations: professionalData.get('positiveEvaluations'),
                    
                    // Dados financeiros
                    bank: documentsData.get('bank'),
                    agency: documentsData.get('agency'),
                    account: documentsData.get('account'),
                    pixKey: documentsData.get('pixKey'),
                    taxStatus: documentsData.get('taxStatus'),
                    cnpj: documentsData.get('cnpj'),
                    normalConsultationPrice: documentsData.get('normalConsultationPrice'),
                    urgentConsultationPrice: documentsData.get('urgentConsultationPrice'),
                    returnConsultationPrice: documentsData.get('returnConsultationPrice'),
                    
                    // Disponibilidade
                    weeklySchedule: weeklySchedule,
                    availableShifts: availableShifts,
                    serviceModalities: serviceModalities,
                    
                    // Requisitos técnicos
                    equipment: equipment,
                    software: software,
                    
                    // Certificações e seguros
                    certifications: certifications,
                    insurance: insurance,
                    
                    // Aspectos legais
                    cfmResolution: documentsData.get('cfmResolution') === 'on',
                    medicalEthics: documentsData.get('medicalEthics') === 'on',
                    civilResponsibility: documentsData.get('civilResponsibility') === 'on',
                    serviceContract: documentsData.get('serviceContract') === 'on',
                    privacyPolicy: documentsData.get('privacyPolicy') === 'on',
                    platformTerms: documentsData.get('platformTerms') === 'on',
                    dataProcessing: documentsData.get('dataProcessing') === 'on',
                    marketingEmails: documentsData.get('marketingEmails') === 'on',
                    
                    // Senha
                    password: documentsData.get('password')
                };

                console.log('Dados do médico:', doctorData);

                // Integração com Supabase - Inserir candidatura médica
                const { data: applicationData, error: applicationError } = await supabase
                    .from('doctors_applications')
                    .insert([{
                        // Dados pessoais
                        full_name: doctorData.fullName,
                        cpf: doctorData.cpf,
                        rg: doctorData.rg,
                        birth_date: doctorData.birthDate,
                        email: doctorData.email,
                        phone: doctorData.phone,
                        address: doctorData.address,
                        gender: doctorData.gender,
                        
                        // Registro profissional
                        crm: doctorData.crm,
                        crm_state: doctorData.crmState,
                        crm_status: doctorData.crmStatus,
                        
                        // Formação acadêmica
                        medical_school: doctorData.medicalSchool,
                        graduation_year: parseInt(doctorData.graduationYear),
                        diploma_recognized: doctorData.diplomaRecognized,
                        completion_certificate: doctorData.completionCertificate,
                        
                        // Especialização
                        rqe: doctorData.rqe,
                        residency_certificate: doctorData.residencyCertificate,
                        specialist_title: doctorData.specialistTitle,
                        specialization_certificates: doctorData.specializationCertificates,
                        
                        // Especialidades
                        specialties: doctorData.specialties,
                        
                        // Experiência
                        experience_years: doctorData.experienceYears,
                        telemedicine_experience: doctorData.telemedicineExperience,
                        publications: doctorData.publications,
                        positive_evaluations: doctorData.positiveEvaluations,
                        
                        // Dados financeiros
                        bank: doctorData.bank,
                        agency: doctorData.agency,
                        account: doctorData.account,
                        pix_key: doctorData.pixKey,
                        tax_status: doctorData.taxStatus,
                        cnpj: doctorData.cnpj,
                        
                        // Precificação
                        normal_consultation_price: parseFloat(doctorData.normalConsultationPrice),
                        urgent_consultation_price: doctorData.urgentConsultationPrice ? parseFloat(doctorData.urgentConsultationPrice) : null,
                        return_consultation_price: doctorData.returnConsultationPrice ? parseFloat(doctorData.returnConsultationPrice) : null,
                        
                        // Disponibilidade
                        weekly_schedule: doctorData.weeklySchedule || [],
                        available_shifts: doctorData.availableShifts || [],
                        service_modalities: doctorData.serviceModalities || [],
                        
                        // Requisitos técnicos
                        equipment: doctorData.equipment || [],
                        software: doctorData.software || [],
                        
                        // Certificações e seguros
                        certifications: doctorData.certifications || [],
                        insurance: doctorData.insurance || [],
                        
                        // Aspectos legais
                        cfm_resolution_accepted: doctorData.cfmResolution,
                        medical_ethics_accepted: doctorData.medicalEthics,
                        civil_responsibility_accepted: doctorData.civilResponsibility,
                        service_contract_accepted: doctorData.serviceContract,
                        privacy_policy_accepted: doctorData.privacyPolicy,
                        platform_terms_accepted: doctorData.platformTerms,
                        data_processing_authorized: doctorData.dataProcessing,
                        marketing_emails_accepted: doctorData.marketingEmails,
                        
                        // Status inicial
                        application_status: 'pending'
                    }]);

                if (applicationError) {
                    console.error('Erro ao salvar candidatura:', applicationError);
                    
                    if (applicationError.code === '23505') {
                        // Violação de constraint única (CPF ou email duplicado)
                        if (applicationError.message.includes('cpf')) {
                            showError('Este CPF já está cadastrado. Verifique se você já possui uma candidatura.');
                        } else if (applicationError.message.includes('email')) {
                            showError('Este email já está cadastrado. Verifique se você já possui uma candidatura.');
                        } else {
                            showError('Dados duplicados encontrados. Verifique CPF e email.');
                        }
                    } else {
                        showError('Erro ao processar candidatura: ' + applicationError.message);
                    }
                    return;
                }

                // Enviar notificação de candidatura recebida
                try {
                    const notificationScript = document.createElement('script');
                    notificationScript.src = 'js/doctor-notifications.js';
                    document.head.appendChild(notificationScript);
                    
                    notificationScript.onload = async () => {
                        const notifications = new DoctorNotificationSystem();
                        await notifications.sendApplicationReceived(applicationData[0]);
                    };
                } catch (notificationError) {
                    console.error('Erro ao enviar notificação:', notificationError);
                    // Não bloquear o fluxo se a notificação falhar
                }

                showSuccess('Candidatura enviada com sucesso! Você receberá um email com as próximas instruções em até 24 horas.');
                
                // Redirecionar após 3 segundos
                setTimeout(() => {
                    window.location.href = 'doctors.html';
                }, 3000);

            } catch (error) {
                console.error('Erro no cadastro:', error);
                showError('Erro ao processar cadastro. Tente novamente.');
            } finally {
                // Restaurar botão
                submitButton.innerHTML = originalText;
                submitButton.disabled = false;
            }
        });

        // Validação de senha em tempo real
        document.getElementById('password').addEventListener('input', (e) => {
            const password = e.target.value;
            const strengthBar = document.getElementById('passwordStrengthBar');
            const hint = document.getElementById('passwordHint');
            
            let strength = 0;
            if (password.length >= 8) strength++;
            if (/[a-z]/.test(password)) strength++;
            if (/[A-Z]/.test(password)) strength++;
            if (/\d/.test(password)) strength++;
            if (/[^a-zA-Z\d]/.test(password)) strength++;
            
            const strengthLevel = strength <= 2 ? 'weak' : strength <= 4 ? 'medium' : 'strong';
            strengthBar.className = `password-strength-bar strength-${strengthLevel}`;
            
            if (password.length === 0) {
                hint.textContent = 'Mínimo 8 caracteres com letras, números e símbolos';
                hint.className = 'text-sm text-gray-500 mt-1';
            } else if (strengthLevel === 'weak') {
                hint.textContent = 'Senha fraca - adicione mais caracteres e símbolos';
                hint.className = 'text-sm text-red-500 mt-1';
            } else if (strengthLevel === 'medium') {
                hint.textContent = 'Senha média - adicione caracteres especiais';
                hint.className = 'text-sm text-yellow-500 mt-1';
            } else {
                hint.textContent = 'Senha forte!';
                hint.className = 'text-sm text-green-500 mt-1';
            }
        });

        // Máscara para CPF
        document.getElementById('cpf').addEventListener('input', (e) => {
            let value = e.target.value.replace(/\D/g, '');
            value = value.replace(/(\d{3})(\d)/, '$1.$2');
            value = value.replace(/(\d{3})(\d)/, '$1.$2');
            value = value.replace(/(\d{3})(\d{1,2})$/, '$1-$2');
            e.target.value = value;
        });

        // Máscara para telefone
        document.getElementById('phone').addEventListener('input', (e) => {
            let value = e.target.value.replace(/\D/g, '');
            value = value.replace(/(\d{2})(\d)/, '($1) $2');
            value = value.replace(/(\d{5})(\d)/, '$1-$2');
            e.target.value = value;
        });

        // Limpar mensagens ao mudar de passo
        document.addEventListener('DOMContentLoaded', () => {
            hideMessages();
        });
    </script>

    <style>
        .password-strength-bar {
            height: 4px;
            border-radius: 2px;
            transition: all 0.3s ease;
            margin-top: 4px;
        }
        
        .strength-weak {
            width: 33%;
            background-color: #ef4444;
        }
        
        .strength-medium {
            width: 66%;
            background-color: #f59e0b;
        }
        
        .strength-strong {
            width: 100%;
            background-color: #22c55e;
        }
    </style>
</body>
</html>